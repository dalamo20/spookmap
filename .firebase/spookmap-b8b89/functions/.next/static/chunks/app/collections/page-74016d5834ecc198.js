(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[798],{5821:function(e,n,t){Promise.resolve().then(t.bind(t,1018))},1018:function(e,n,t){"use strict";t.r(n),t.d(n,{dynamic:function(){return i}});var o=t(7437),c=t(2265),l=t(605),a=t(9376),s=t(3145);let i="force-dynamic";n.default=()=>{let{data:e}=(0,l.useSession)(),[n,t]=(0,c.useState)([]),[i,r]=(0,c.useState)(""),[d,u]=(0,c.useState)(null),[h,m]=(0,c.useState)(""),g=(0,a.useRouter)();(0,c.useEffect)(()=>{if(e){var n;console.log("Session Data:",e),console.log("User Email:",null==e?void 0:null===(n=e.user)||void 0===n?void 0:n.email),p()}},[e]);let p=async()=>{try{var n;let o=await fetch("/api/collections?userId=".concat(null==e?void 0:null===(n=e.user)||void 0===n?void 0:n.email)),c=await o.json();console.log("Fetched Collections:",c),t(c.collections||[])}catch(e){console.error("Error fetching collections:",e),t([])}},j=async()=>{if(!i){console.error("Missing collection name");return}try{var o;let c=await fetch("/api/collections/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:i,userEmail:null==e?void 0:null===(o=e.user)||void 0===o?void 0:o.email})}),l=await c.json();console.log("Created Collection:",l),l.success&&(t([...n,{id:l.collectionId,name:i}]),r(""))}catch(e){console.error("Error creating collection:",e)}},v=async e=>{try{await fetch("/api/collections/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({collectionId:e})}),console.log("Deleted Collection ID:",e),t(n.filter(n=>n.id!==e))}catch(e){console.error("Error deleting collection:",e)}},f=(e,n)=>{u(e),m(n)},N=async()=>{if(d&&h.trim())try{let e=await fetch("/api/collections/update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({collectionId:d,newName:h})});(await e.json()).success&&(t(n.map(e=>e.id===d?{...e,name:h}:e)),u(null),m(""))}catch(e){console.error("Error updating collection:",e)}},x=e=>{console.log("Navigating to collection:",e),g.push("/collections/".concat(e))};return e?(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{className:"collections-container",children:[(0,o.jsxs)("div",{className:"nav-div",children:[(0,o.jsx)("div",{className:"home-content",children:(0,o.jsx)(s.default,{src:"/images/SpookMap_logo.svg",alt:"Spooky background image",width:300,height:200,className:"ghost-image"})}),(0,o.jsxs)("div",{className:"btn-cont",children:[(0,o.jsx)("button",{className:"collections-btn home-btn",onClick:()=>window.location.href="/home",children:(0,o.jsx)("span",{children:"Home"})}),(0,o.jsx)("a",{className:"signOutBtn",onClick:()=>(0,l.signOut)({callbackUrl:"/"}),children:"Sign Out"})]})]}),(0,o.jsxs)("div",{className:"manage-container",children:[(0,o.jsx)("p",{className:"cust-heading",children:"Manage Your Collections"}),(0,o.jsxs)("div",{className:"coll-input-container",children:[(0,o.jsx)("input",{type:"text",placeholder:"New collection name",value:i,onChange:e=>r(e.target.value)}),(0,o.jsx)("button",{className:"collections-btn create-btn",onClick:j,children:"Create Collection"})]})]}),(0,o.jsx)("div",{className:"collections-grid",children:n.length>0?n.map(e=>(0,o.jsx)("div",{className:"collection-card",style:{cursor:"pointer"},children:d===e.id?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("input",{type:"text",value:h,onChange:e=>m(e.target.value),placeholder:"New collection name"}),(0,o.jsx)("button",{onClick:N,className:"update-btn",children:"Save"})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.default,{className:"city-img",src:"/images/city.jpg",alt:"city",width:100,height:100,onClick:()=>x(e.id)}),(0,o.jsx)("button",{onClick:()=>f(e.id,e.name),className:"edit-btn",children:"Edit"}),(0,o.jsxs)("div",{className:"card-content",children:[(0,o.jsx)("h3",{className:"collection-name",children:e.name}),(0,o.jsx)(s.default,{onClick:()=>v(e.id),className:"delete-btn",src:"/images/delete.png",alt:"trash icon",width:30,height:30})]})]})},e.id)):(0,o.jsx)("p",{children:"No collections found."})})]})}):(0,o.jsx)("p",{children:"Please log in to manage your collections."})}},9376:function(e,n,t){"use strict";var o=t(5475);t.o(o,"useParams")&&t.d(n,{useParams:function(){return o.useParams}}),t.o(o,"useRouter")&&t.d(n,{useRouter:function(){return o.useRouter}}),t.o(o,"useSearchParams")&&t.d(n,{useSearchParams:function(){return o.useSearchParams}})}},function(e){e.O(0,[605,145,971,117,744],function(){return e(e.s=5821)}),_N_E=e.O()}]);